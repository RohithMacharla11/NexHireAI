{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user within the NexHireAI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "User's display name."
        },
        "role": {
          "type": "string",
          "description": "The role of the user (Candidate, Recruiter, Admin)."
        },
        "xp": {
          "type": "number",
          "description": "User's total experience points."
        },
        "badges": {
          "type": "array",
          "description": "List of badges earned by the user.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "email",
        "displayName",
        "role"
      ]
    },
    "Assessment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Assessment",
      "type": "object",
      "description": "Represents an assessment taken by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the assessment."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Assessment)"
        },
        "role": {
          "type": "string",
          "description": "The role the assessment is for."
        },
        "subskills": {
          "type": "array",
          "description": "List of subskills covered in the assessment.",
          "items": {
            "type": "string"
          }
        },
        "score": {
          "type": "number",
          "description": "The score obtained by the user in the assessment."
        },
        "completionDate": {
          "type": "string",
          "description": "Date and time when the assessment was completed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "role",
        "score",
        "completionDate"
      ]
    },
    "Question": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Question",
      "type": "object",
      "description": "Represents a question within an assessment.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the question."
        },
        "assessmentId": {
          "type": "string",
          "description": "Reference to Assessment. (Relationship: Assessment 1:N Question)"
        },
        "type": {
          "type": "string",
          "description": "Type of question (MCQ, coding challenge, written answer, scenario/case-study)."
        },
        "text": {
          "type": "string",
          "description": "The text of the question."
        },
        "subskill": {
          "type": "string",
          "description": "The subskill the question assesses."
        },
        "difficulty": {
          "type": "string",
          "description": "Difficulty level of the question."
        }
      },
      "required": [
        "id",
        "assessmentId",
        "type",
        "text",
        "subskill",
        "difficulty"
      ]
    },
    "Submission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Submission",
      "type": "object",
      "description": "Represents a user's submission to a question.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the submission."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Submission)"
        },
        "questionId": {
          "type": "string",
          "description": "Reference to Question. (Relationship: Question 1:N Submission)"
        },
        "answer": {
          "type": "string",
          "description": "The user's answer to the question."
        },
        "submissionDate": {
          "type": "string",
          "description": "Date and time when the answer was submitted.",
          "format": "date-time"
        },
        "score": {
          "type": "number",
          "description": "Score awarded for the submission."
        },
        "feedback": {
          "type": "string",
          "description": "AI generated feedback for the submission."
        }
      },
      "required": [
        "id",
        "userId",
        "questionId",
        "answer",
        "submissionDate",
        "score"
      ]
    },
    "LearningRoadmap": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LearningRoadmap",
      "type": "object",
      "description": "Represents a personalized learning roadmap for a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the learning roadmap."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N LearningRoadmap)"
        },
        "resources": {
          "type": "array",
          "description": "List of resources (tutorials, videos, projects) in the roadmap.",
          "items": {
            "type": "string"
          }
        },
        "progress": {
          "type": "number",
          "description": "User's progress in completing the roadmap (e.g., percentage complete)."
        }
      },
      "required": [
        "id",
        "userId",
        "resources",
        "progress"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles.  Path-based ownership ensures only the user can access their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/assessments/{assessmentId}",
        "definition": {
          "entityName": "Assessment",
          "schema": {
            "$ref": "#/backend/entities/Assessment"
          },
          "description": "Stores assessments taken by a user. Path-based ownership ensures only the user can access their assessments.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "assessmentId",
              "description": "The unique identifier of the assessment."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/assessments/{assessmentId}/questions/{questionId}",
        "definition": {
          "entityName": "Question",
          "schema": {
            "$ref": "#/backend/entities/Question"
          },
          "description": "Stores questions within an assessment. Path-based ownership ensures only the user can access questions in their assessments.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "assessmentId",
              "description": "The unique identifier of the assessment."
            },
            {
              "name": "questionId",
              "description": "The unique identifier of the question."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/submissions/{submissionId}",
        "definition": {
          "entityName": "Submission",
          "schema": {
            "$ref": "#/backend/entities/Submission"
          },
          "description": "Stores user submissions to questions. Path-based ownership ensures only the user can access their submissions.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "submissionId",
              "description": "The unique identifier of the submission."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/learningRoadmaps/{learningRoadmapId}",
        "definition": {
          "entityName": "LearningRoadmap",
          "schema": {
            "$ref": "#/backend/entities/LearningRoadmap"
          },
          "description": "Stores personalized learning roadmaps for a user. Path-based ownership ensures only the user can access their learning roadmap.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "learningRoadmapId",
              "description": "The unique identifier of the learning roadmap."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure security, scalability, and ease of debugging, adhering to the principles of Authorization Independence, Clarity of Intent, DBAC, and QAPs.  \n\nAuthorization Independence is achieved through denormalization. For example, if access to Assessments, Questions, Submissions or LearningRoadmaps depended on user roles, this data would be copied into each document within those collections.  However, based on the data provided, all subcollections are under a user document and authorization is granted via path based ownership.\n\nStructural Segregation is used to keep documents with similar access requirements in the same collection. For example, all user profiles are stored in `/users/{userId}`.\n\nAccess Modeling relies on path-based ownership. All entities directly related to a user (Assessments, Submissions, LearningRoadmaps) are stored as subcollections under the `/users/{userId}` path.  This ensures that only the user has access to their own data.  The Admin role is not modeled as it is external to the data models provided."
  }
}